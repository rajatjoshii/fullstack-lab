# Use Node LTS
FROM node:18-alpine

WORKDIR /app

# 1) Install deps using cached layers
COPY package*.json ./
# Use ci if you have a package-lock.json
RUN npm ci || npm install

# 2) Copy source (will be overlaid by bind mount at runtime, but helps for first build)
COPY . .

# Enable file watching inside container
ENV CHOKIDAR_USEPOLLING=true
ENV WATCHPACK_POLLING=true

# Angular dev server port
EXPOSE 4200

# Bind to 0.0.0.0 so it's reachable outside the container
# Add polling so file changes from host are detected
CMD ["npm", "run", "start:docker"]
